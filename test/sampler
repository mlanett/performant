#!/usr/bin/env ruby
# -*- encoding: utf-8 -*-

require "bundler/setup"

require "performant"
require "thor"

class Sampler < Thor

  desc "sample", "run the sampler"

  method_options :environment,  alias: "-e", default: "development"
  method_options :config,       alias: "-c", default: File.expand_path( "../example.yml", __FILE__ )
  method_options :jobs,         alias: "-j", type: :array, default: [ "stress", "fake" ]

  def sample
    Performant::Configuration.load! src: options.config, env: options.environment
    Performant.sampler(jobs).run
  end
end

Sampler.start if __FILE__ == $0
